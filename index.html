<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">

    <title>reveal.js - The HTML Presentation Framework</title>
    <meta content="A framework for easily creating beautiful presentations using HTML" name="description">
    <meta content="Hakim El Hattab" name="author">
    <meta content="yes" name="apple-mobile-web-app-capable">
    <meta content="black-translucent" name="apple-mobile-web-app-status-bar-style">
    <meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"name="viewport">
    <link href="css/reveal.min.css" rel="stylesheet" type="text/css">
    <link href="css/theme/default.css" id="theme" rel="stylesheet" type="text/css">
	<!-- For syntax highlighting -->
    <link href="lib/css/zenburn.css" rel="stylesheet" type="text/css">
    <!-- If the query includes 'print-pdf', include the PDF print sheet -->

    <script type="text/javascript">
            if( window.location.search.match( /print-pdf/gi ) ) {
                var link = document.createElement( 'link' );
                link.rel = 'stylesheet';
                link.type = 'text/css';
                link.href = 'css/print/pdf.css';
                document.getElementsByTagName( 'head' )[0].appendChild( link );
            }
    </script>
    <!--[if lt IE 9]>
        <script src="lib/js/html5shiv.js"></script>
        <![endif]-->
	<style>
	li { padding: 8px !important;}
	</style>
</head>

<body>
    <div class="reveal">
		
		
		
		
		
		
		
		
		
		
        <!-- CONTENT FROM SLIDES START -->

<div class="slides">
	<section class="" data-id="2bf28a6f94a00705b335d219845b4be1">
		<h2>Multivariate "cape"</h2>

		<div>
			<br>
			<br>
		</div>

		<div>Allan Jiang</div>

		<div>July 22, 2014</div>

		<div>Carter Lab Meeting</div>
	</section>

	<section class="" data-id="5cc5c7e9cd4c595767fd0b3f5a567fcb">
		<h2>Detecting Epistasis</h2>

		<div>
			<br>
		</div>

		<div style="text-align: left;">
			<ul>
				<li style="font-size: 36.60322189331055px; font-style: normal; font-variant: normal;">
				<b>Goal:&nbsp;</b>We want to find gene-gene interactions for complex traits in
					a dataset of genotype and phenotype data</li>
			</ul>

			<div>
				<br>
			</div>

			<ul>
				<li class="fragment" data-fragment-index="0" style="font-size: 36.60322189331055px; font-style: normal; font-variant: normal;">
				<b>Current Solution:</b>&nbsp;<code>cape</code>&nbsp;is a statistical method
					that uses linear modeling to address this problem</li>
			</ul>

			<div>
				<br>
			</div>

			<ul>
				<li class="fragment" data-fragment-index="1" style="font-size: 36.60322189331055px; font-style: normal; font-variant: normal;">
				<b>Problem:&nbsp;</b>Unfortunately, current&nbsp;<span style="font-family: monospace; font-size: 36.60322189331055px; font-style: normal; font-variant: normal;">cape</span>&nbsp;analysis<span style="font-size: 36.60322189331055px; font-style: normal; font-variant: normal;">&nbsp;may provide an incomplete model to describe these interactions</span></li>
			</ul>
		</div>
	</section>

	<section class="" data-id="73148c970731612544a19e3e674c68ff">
		<h2>Presentation Overview:</h2>

		<div>
			<br>
		</div>

		<div style="text-align: left;">
			<div><span>1. Mathematical look at current <code>cape</code> model</span>
			</div>

			<div>
				<br>
			</div>

			<div><span>2. How I extended the model</span>
			</div>

			<div>
				<br>
			</div>

			<div><span>3. My analysis on the "little cross" dataset</span>
			</div>

			<div>
				<br>
			</div>

			<div><span>4. Next steps...</span>
			</div>
		</div>
	</section>

	<section class="stack" data-id="0fcf1b598e20ae9bf800227084c2b47c">
		<section class="" data-id="50a23a0ab9ac19b43e1d4480295d0f2c">
			<h2><b>Section 1</b><br>
				Current <code>cape</code> model</h2>
			<br>
		</section>

		<section class="" data-id="3a570defb70406f18f4d2252f5f9d3d5">
			<h2>An Additive Model</h2>

			<div><br>
			</div>

			<div style="text-align: left;">
				<ul>
					<li><b>Key assumption</b> that allows us to go from correlation to
						causality</li>
				</ul>

				<ul>
					<li>Encode genotypes as 0, 1, and 2</li>

					<li>Perform linear regression</li>
				</ul>

				<div style="padding:20px;">$$y \sim \beta_0 + \beta_1x_1 + \epsilon$$</div>

				<div>
					<ul>
						<li>A significant \(\beta_1\) value indicates correlation between marker and
							phenotype</li>
					</ul>

					<ul>
						<li>Biologically, influence is from genotype to phenotype.</li>
					</ul>
				</div>
			</div>
		</section>

		<section class="" data-id="4c08cf9e03c49fd8bf17ad49105238a8">
			<h2>Is it reasonable?</h2>
			<iframe src="https://www.biostat.wisc.edu/~kbroman/D3/cistrans/" style=
			"position: relative;left: -130px; width: 1240px; height: 700px; max-height: none; max-width: none;position: 			relative;left: -110px;"></iframe>
		</section>

		<section class="" data-id="c73f31975acd31a406952968485fccd5">
			<h2>Pairscan</h2>

			<div style="text-align: left;"><br>
			</div>

			<div style="text-align: left;">This gives us combined variant effects. Perform
				the regression</div>

			<div style="text-align: left; padding:20px">
				$$y \sim \beta_0 + \beta_1x_1 + \beta_1x_2 + \beta_{12}x_1x_2 + \epsilon$$</div>

			<div style="text-align: left;">Then, a significant&nbsp;\(\beta_{12}\)
				indicates the degree to which phenotype changes are explained by a strong
			<i>combined</i>&nbsp;variant effect.</div>
		</section>

		<section class="" data-id="72c26b59b5891b05d065870359596e5e">
			<h2>Pairscan</h2>

			<div style="text-align: left;"><br>
				But how to convert a combined effect into variant-to-variant effects?<br></div>

			<h2><img src="https://s3.amazonaws.com/media-p.slid.es/uploads/jiangts/images/526607/pasted-from-clipboard.png"
style="color: rgb(0, 0, 0); width: 343.2581745574043px; height: 275.89214442324857px; max-height: none; max-width: none;">&nbsp;
&nbsp;<img src="https://s3.amazonaws.com/media-p.slid.es/uploads/jiangts/images/526634/pasted-from-clipboard.png"
style="color: rgb(0, 0, 0); width: 375.8477304383218px; height: 304.8773177083422px; max-height: none; max-width: none;"></h2>
		</section>

		<section class="" data-id="f65fea28774daf7da6f5551e3c7e6a83">
			<h2>Mathematics</h2>

			<div style="text-align: left;">The Pairscan: Let</div>

			<div><br>
			</div>

			<div>$$ \scriptsize 
				\boldsymbol{Y} = 
				\left[ \begin{array}{cc} 
				1.5 &amp; -0.3 \\
				1.2 &amp; -0.4 \\ 
				1.1 &amp; -0.5 \\ 
				1.3 &amp; -0.3 \\ 
				\vdots &amp; \vdots
				\end{array}\right] 
			
				\hspace{10mm} 
				\boldsymbol{X} = 
				\left[ \begin{array}{cccc} 
				1 &amp; 0 &amp; 0 &amp; 0 \\ 
				1 &amp; 0 &amp; 1 &amp; 0 \\ 
				1 &amp; 1 &amp; 0 &amp; 0 \\ 
				1 &amp; 1 &amp; 1 &amp; 1 \\ 
				\vdots &amp; \vdots &amp; \vdots &amp; \vdots
				\end{array}\right] 
			
				\hspace{10mm} 
			
				\boldsymbol{B} = 
				\left[ \begin{array}{cc}
				\beta_0^1 &amp; \beta_0^2 \\ 
				\beta_1^1 &amp; \beta_1^2 \\ 
				\beta_2^1 &amp; \beta_2^2 \\ 
				\beta_{12}^1 &amp; \beta_{12}^2 
				\end{array}\right] $$
			</div>

			<div><br>
			</div>

			<div class="fragment" data-fragment-index="0" style="text-align: left;">Then,
	we want to find the optimal beta matrix for the regression</div>

		<div class="fragment" data-fragment-index="0">
			$$\boldsymbol{Y} \sim \boldsymbol{X} \cdot \boldsymbol{B} + \epsilon$$</div>
		</section>

		<section class="" data-id="a55412a551fcae9bf98a83e25d8ade9f">
			<h2>Mathematics</h2>

			<div style="text-align: left;">Suppose we can include the variant-to-variant
	effects (which disturb additivity) <b>before</b>&nbsp;we perform the
	regression.</div>

			<div><br>
			</div>

			<div class="fragment" data-fragment-index="0">
				$$ 
				\scriptsize 
				\boldsymbol{X}\cdot \boldsymbol{I} = 
				\left[ \begin{array}{cccc} 
				1 &amp; 0 &amp; 0 &amp; 0 \\ 
				1 &amp; 0 &amp; 1 &amp; 0 \\ 
				1 &amp; 1 &amp; 1 &amp; 1 \\ 
				\vdots &amp; \vdots &amp; \vdots &amp; \vdots 
				\end{array}\right] 
				\cdot 
				\left[ \begin{array}{ccc} 
				1 &amp; 0 &amp; 0 \\ 
				0 &amp; 1 &amp; 0 \\ 
				0 &amp; 0 &amp; 1 \\ 
				0 &amp; \delta_{21} &amp; \delta_{12} 
				\end{array}\right] 
				$$
				<br>
				$$ 
				\scriptsize
				 = \left[ \begin{array}{ccc} 
				 1 &amp; 0 &amp; 0 \\ 
				 1 &amp; 0 &amp; 1 \\ 
				 1 &amp; 1+\delta_{21} &amp; 1+\delta_{12} \\ 
				 \vdots &amp; \vdots &amp; \vdots 
				 \end{array}\right] 
				 $$
			 </div>
		</section>

		<section class="" data-id="270ac18aabe7375d5c9a8e1772b7963d">
			<h2>Mathematics</h2>

			<div style="text-align: left;">Now, we may "reparameterize" the model. Let</div>

			<div><br>
			</div>

			<div>$$ \scriptsize \boldsymbol{B_{ME}} = \left[ \begin{array}{cc} \beta_0^1
	&amp; \beta_0^2 \\ \beta_1^1 &amp; \beta_1^2 \\ \beta_2^1 &amp; \beta_2^2
	\end{array}\right] $$

			<div style="text-align: left;"><br>Then,<br><br></div>
				$$ 
				\scriptsize 
				\begin{array}{l} 
				\boldsymbol{Y} \sim \boldsymbol{X} \cdot \boldsymbol{I} \cdot \boldsymbol{B_{ME}} + \epsilon \\ 
				\boldsymbol{Y} \sim \boldsymbol{X} \cdot \boldsymbol{B} + \epsilon 
				\end{array} 
				\implies
				\boldsymbol{I} \cdot \boldsymbol{B_{ME}} = \boldsymbol{B} 
				$$
			</div>
		</section>

		<section class="" data-id="d584970eedaa5ac182f248fb1622c8ca">
			<h2>Reparameterization</h2>

			<div style="left: -75px;position: relative;"><br>
				$$ \scriptsize 
				\boldsymbol{I} \cdot \boldsymbol{B_{ME}} 
				= 
				\left[ \begin{array}{ccc} 
				1 &amp; 0 &amp; 0 \\ 
				0 &amp; 1 &amp; 0 \\ 
				0 &amp; 0 &amp; 1 \\ 
				0 &amp; \delta_{21} &amp; \delta_{12} 
				\end{array}\right] 
				\cdot 
				\left[\begin{array}{cc} 
				\beta_0^1 &amp; \beta_0^2 \\ 
				\beta_1^1 &amp; \beta_1^2 \\
				\beta_2^1 &amp; \beta_2^2 
				\end{array}\right] 
				= 
				\left[ 
				\begin{array}{cc}
				\beta_0^1 &amp; \beta_0^2 \\ 
				\beta_1^1 &amp; \beta_1^2 \\ 
				\beta_2^1 &amp; \beta_2^2 \\ 
				\beta_1^1\delta_{21}+\beta_2^1\delta_{12} &amp; \beta_1^2\delta_{21} + \beta_2^2\delta_{12} 
				\end{array}\right] 
				$$
			</div>

			<div><br>
				$$ \scriptsize 
				\implies \begin{array}{l} 
				\beta_{12}^1 = \beta_1^1\delta_{21}+\beta_2^1\delta_{12} \\ 
				\beta_{12}^2 = \beta_1^2\delta_{21} + \beta_2^2\delta_{12} 
				\end{array} 
				$$
			</div>

			<div style="text-align: left; font-size:30px"><br>
				Now, we can solve for activity changes \(\delta\) in terms of the coefficients
				of our pairscan.
			</div>
		</section>

		<section class="" data-id="7f48083a60ca24e9ac7dd62b914774e5">
			<h2>Creating a network</h2>

			<div style="text-align: left;">Determining influence variables from activity
				variables:
			</div>

			<div>
				<br>
				$$ 
				\begin{array}{l} 
				\delta_{21} = m_{21}(1 + \delta_{12}) \\ 
				\delta_{12} = m_{12}(1 + \delta_{21}) 
				\end{array} 
				$$
				<br>
			</div>
			<img src="https://s3.amazonaws.com/media-p.slid.es/uploads/jiangts/images/526820/normal_cape_network.png"
style="width: 794.5765750809998px; height: 354.2581745574043px; max-height: none; max-width: none;">
		</section>
	</section>

	<section class="stack" data-id="ca9c6b6849196390345f68f704589e2d">
		<section class="" data-id="189e2cd60d70db8358dadf528a3e258c">
			<h2><b>Section 2</b><br>
				Extending the Model
			</h2>
			<br>
		</section>

		<section class="" data-id="1db838cc5a8f5ee0349e7aea5f23e726">
			<h2>A more complete model</h2>
			<div style="text-align:left;">
				<ul>
					<li><span>The limitation of</span> <code>cape</code> <span>is that the model
						only considers two variants at a time without regard to other
						variants.</span>
					</li>

					<li class="fragment" data-fragment-index="0"><span>A more complete model
						includes multiple variants. This could help to:</span>
					</li>

					<ul>
						<li class="fragment" data-fragment-index="0"><span>detect false positive
							edges</span>
						</li>

						<li class="fragment" data-fragment-index="0"><span>detect hidden edges</span>
						</li>
					</ul>
				</ul>
			</div>
		</section>

		<section class="" data-id="9ef3fc5c097601554ae66042881da494">
			<h2>Including more variants</h2>

			<div style="text-align: left;"><br>
				How do you model interactions among multiple variants?
			</div>

			<div style="text-align: left;"><br>
			</div>
			<img src="https://s3.amazonaws.com/media-p.slid.es/uploads/jiangts/images/526947/three-var-true-influence.png"
			style="width: 390.16074301606704px; height: 340.8643238985463px; max-height: none; max-width: none;">
		</section>

		<section class="" data-id="5d079c9e6402c5eafe5d5363277061f6">
			<h2 style="font-style: normal; font-variant: normal;">Including more
				variants
			</h2>

			<div style="text-align: left;"><br>
				How about this perspective?
			</div>

			<div>
				$$ 
				\scriptsize 
				\begin{array}{c c c c c c c} 
				x_1 &amp; x_2 &amp; x_3 &amp; &amp; x_1 &amp; x_2 &amp; x_3 \\ \hline 
				1 &amp; 0 &amp; 1 &amp; \longrightarrow &amp; 1 + \delta_{31} &amp; 0 &amp; 1 + \delta_{13} \\ \hline 
				1 &amp; 1 &amp; 1 &amp; \longrightarrow &amp; 
					\begin{array}{c} 
						1 + \delta_{21} + \delta_{31} \\ 
						+ \delta_{231} + \delta_{321} 
					\end{array} &amp; 
					\begin{array}{c} 
						1 + \delta_{12} + \delta_{32} \\ 
						+ \delta_{132} + \delta_{312} 
					\end{array} &amp; 
					\begin{array}{c} 
						1 + \delta_{13} + \delta_{23} \\ 
						+ \delta_{123} + \delta_{213} 
					\end{array} 
				\end{array} 
				$$
			</div>

			<div style="text-align: left;">
				<div style="float:left;"><img src="https://s3.amazonaws.com/media-p.slid.es/uploads/jiangts/images/526947/three-var-true-influence.png"
					style="height: 250px;">
				</div>

				<div class="fragment" data-fragment-index="0" style=
				"float:right; width:550px;"><br>
				<br>
				All routes of influence through <b>active</b> variants are considered!</div>
			</div>
		</section>

		<section class="" data-id="64b4a7e1f3eda2a2ae1c2328a2b3dd2e">
			<h2>How do we implement that?</h2>

			<div style="text-align: left;">Like in cape, we need to find an interaction
				matrix \(\boldsymbol{I}\) that will perturb our design matrix in the desired
				fashion.
			</div>

			<div style="text-align: left;"><br>
			</div>
<!-- div style="text-align: left; " class="fragment" data-fragment-index="0">I will spare you the math ☺</div -->

			<div class="fragment" data-fragment-index="0" style="text-align: left;">
				Note: the new model requires information about all combinations of variants.
			</div>

			<div style="text-align: left;"><br>
			</div>

			<div class="fragment" data-fragment-index="1" style="text-align: left;">Limits
				number of variants you can analyse &ndash; I'm currently doing 5
				variants.
			</div>
		</section>

		<section class="" data-id="c00a034a46b6526a1c8f43a5b92c7f58">
			<h2>Solving for deltas</h2>

			<div style="text-align: left; font-size:30px">What results is a system of
				equations that allows us to solve for activity variables delta in terms of our
				regression coefficients beta.<br>
			</div>

			<div><br>
				$$ 
				\scriptsize 
				\begin{cases} 
				\beta_{12} = \beta_1\delta_{21} + \beta_2\delta_{12} \\ 
				\beta_{13} = \beta_1\delta_{31} + \beta_3\delta_{13} \\ 
				\beta_{23} = \beta_2\delta_{32} + \beta_3\delta_{23} \\ 
				\begin{array}{l} 
					\beta_{123} = \\ 
					\\ 
					\\ 
				\end{array} 
				\begin{array}{l} 
					\beta_1(\delta_{21} + \delta_{31} + \delta_{231} + \delta_{321}) + \\ 
					\beta_2(\delta_{12} + \delta_{32} + \delta_{132} + \delta_{312}) + \\ 
					\beta_3(\delta_{13} + \delta_{23} + \delta_{123} + \delta_{213}) 
				\end{array} 
				\end{cases}\\ 
				$$
			</div>

			<div style="font-size:20px;">*Looped over all phenotype coefficient
				values
			</div>

			<div class="fragment" data-fragment-index="0" style=
				"text-align: left; font-size:30px">
				<ul>
					<li>Least Squares Regression</li>

					<li>Levenberg Marquardt Optimization</li>
				</ul>
			</div>
		</section>

		<section>
			<h2>Solving for influence variables <i>m</i></h2>
		</section>
	</section>

	<section class="" data-id="de779d06729a1ba827dad095086d1247">
		<h2 style="font-weight: bold">Section 3</h2>

		<h2>Analysis on the "little cross" dataset</h2>
	</section>

	<section class="" data-id="37834ab6bbab07e4d4ef9779ac92f130">
		<h2 style="font-weight: bold">Section 4</h2>

		<h2>Future Work</h2>
	</section>
</div>




        <!-- CONTENT FROM SLIDES END -->
		
		
		
		
		
		
		
		
		
		
		
		
        <script src="lib/js/head.min.js" type="text/javascript"></script> <script src="js/reveal.min.js" type="text/javascript"></script> <script type="text/javascript">
            // Full list of configuration options available here:
            // https://github.com/hakimel/reveal.js#configuration
            Reveal.initialize({
                controls: true,
                progress: true,
                slideNumber: true,
                history: true,
                center: true,

                theme: 'jiang', //Reveal.getQueryHash().theme, // available themes are in /css/theme
                transition: Reveal.getQueryHash().transition || 'linear', // default/cube/page/concave/zoom/linear/fade/none

                // Parallax scrolling
                // parallaxBackgroundImage: 'https://s3.amazonaws.com/hakim-static/reveal-js/reveal-parallax-1.jpg',
                // parallaxBackgroundSize: '2100px 900px',

                math: {
                    // mathjax: 'http://cdn.mathjax.org/mathjax/latest/MathJax.js',
                    config: 'TeX-AMS_HTML-full'
                },
                
                // Optional libraries used to extend on reveal.js
                dependencies: [
                    { src: 'lib/js/classList.js', condition: function() { return !document.body.classList; } },
                    { src: 'plugin/markdown/marked.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
                    { src: 'plugin/markdown/markdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
                    { src: 'plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } },
                    { src: 'plugin/zoom-js/zoom.js', async: true, condition: function() { return !!document.body.classList; } },
                    { src: 'plugin/notes/notes.js', async: true, condition: function() { return !!document.body.classList; } }
                ]
            });
        </script> <script src=
        "https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"
        type="text/javascript"></script> 
    <script src="https://google-code-prettify.googlecode.com/svn/loader/run_prettify.js"></script>
    </div>
</body>
</html>