<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>

<title>Extending R/cape: Multivariant Analysis</title>

<!-- Styles for R syntax highlighter -->
<style type="text/css">
   pre .operator,
   pre .paren {
     color: rgb(104, 118, 135)
   }

   pre .literal {
     color: #990073
   }

   pre .number {
     color: #099;
   }

   pre .comment {
     color: #998;
     font-style: italic
   }

   pre .keyword {
     color: #900;
     font-weight: bold
   }

   pre .identifier {
     color: rgb(0, 0, 0);
   }

   pre .string {
     color: #d14;
   }
</style>

<!-- R syntax highlighter -->
<script type="text/javascript">
var hljs=new function(){function m(p){return p.replace(/&/gm,"&amp;").replace(/</gm,"&lt;")}function f(r,q,p){return RegExp(q,"m"+(r.cI?"i":"")+(p?"g":""))}function b(r){for(var p=0;p<r.childNodes.length;p++){var q=r.childNodes[p];if(q.nodeName=="CODE"){return q}if(!(q.nodeType==3&&q.nodeValue.match(/\s+/))){break}}}function h(t,s){var p="";for(var r=0;r<t.childNodes.length;r++){if(t.childNodes[r].nodeType==3){var q=t.childNodes[r].nodeValue;if(s){q=q.replace(/\n/g,"")}p+=q}else{if(t.childNodes[r].nodeName=="BR"){p+="\n"}else{p+=h(t.childNodes[r])}}}if(/MSIE [678]/.test(navigator.userAgent)){p=p.replace(/\r/g,"\n")}return p}function a(s){var r=s.className.split(/\s+/);r=r.concat(s.parentNode.className.split(/\s+/));for(var q=0;q<r.length;q++){var p=r[q].replace(/^language-/,"");if(e[p]){return p}}}function c(q){var p=[];(function(s,t){for(var r=0;r<s.childNodes.length;r++){if(s.childNodes[r].nodeType==3){t+=s.childNodes[r].nodeValue.length}else{if(s.childNodes[r].nodeName=="BR"){t+=1}else{if(s.childNodes[r].nodeType==1){p.push({event:"start",offset:t,node:s.childNodes[r]});t=arguments.callee(s.childNodes[r],t);p.push({event:"stop",offset:t,node:s.childNodes[r]})}}}}return t})(q,0);return p}function k(y,w,x){var q=0;var z="";var s=[];function u(){if(y.length&&w.length){if(y[0].offset!=w[0].offset){return(y[0].offset<w[0].offset)?y:w}else{return w[0].event=="start"?y:w}}else{return y.length?y:w}}function t(D){var A="<"+D.nodeName.toLowerCase();for(var B=0;B<D.attributes.length;B++){var C=D.attributes[B];A+=" "+C.nodeName.toLowerCase();if(C.value!==undefined&&C.value!==false&&C.value!==null){A+='="'+m(C.value)+'"'}}return A+">"}while(y.length||w.length){var v=u().splice(0,1)[0];z+=m(x.substr(q,v.offset-q));q=v.offset;if(v.event=="start"){z+=t(v.node);s.push(v.node)}else{if(v.event=="stop"){var p,r=s.length;do{r--;p=s[r];z+=("</"+p.nodeName.toLowerCase()+">")}while(p!=v.node);s.splice(r,1);while(r<s.length){z+=t(s[r]);r++}}}}return z+m(x.substr(q))}function j(){function q(x,y,v){if(x.compiled){return}var u;var s=[];if(x.k){x.lR=f(y,x.l||hljs.IR,true);for(var w in x.k){if(!x.k.hasOwnProperty(w)){continue}if(x.k[w] instanceof Object){u=x.k[w]}else{u=x.k;w="keyword"}for(var r in u){if(!u.hasOwnProperty(r)){continue}x.k[r]=[w,u[r]];s.push(r)}}}if(!v){if(x.bWK){x.b="\\b("+s.join("|")+")\\s"}x.bR=f(y,x.b?x.b:"\\B|\\b");if(!x.e&&!x.eW){x.e="\\B|\\b"}if(x.e){x.eR=f(y,x.e)}}if(x.i){x.iR=f(y,x.i)}if(x.r===undefined){x.r=1}if(!x.c){x.c=[]}x.compiled=true;for(var t=0;t<x.c.length;t++){if(x.c[t]=="self"){x.c[t]=x}q(x.c[t],y,false)}if(x.starts){q(x.starts,y,false)}}for(var p in e){if(!e.hasOwnProperty(p)){continue}q(e[p].dM,e[p],true)}}function d(B,C){if(!j.called){j();j.called=true}function q(r,M){for(var L=0;L<M.c.length;L++){if((M.c[L].bR.exec(r)||[null])[0]==r){return M.c[L]}}}function v(L,r){if(D[L].e&&D[L].eR.test(r)){return 1}if(D[L].eW){var M=v(L-1,r);return M?M+1:0}return 0}function w(r,L){return L.i&&L.iR.test(r)}function K(N,O){var M=[];for(var L=0;L<N.c.length;L++){M.push(N.c[L].b)}var r=D.length-1;do{if(D[r].e){M.push(D[r].e)}r--}while(D[r+1].eW);if(N.i){M.push(N.i)}return f(O,M.join("|"),true)}function p(M,L){var N=D[D.length-1];if(!N.t){N.t=K(N,E)}N.t.lastIndex=L;var r=N.t.exec(M);return r?[M.substr(L,r.index-L),r[0],false]:[M.substr(L),"",true]}function z(N,r){var L=E.cI?r[0].toLowerCase():r[0];var M=N.k[L];if(M&&M instanceof Array){return M}return false}function F(L,P){L=m(L);if(!P.k){return L}var r="";var O=0;P.lR.lastIndex=0;var M=P.lR.exec(L);while(M){r+=L.substr(O,M.index-O);var N=z(P,M);if(N){x+=N[1];r+='<span class="'+N[0]+'">'+M[0]+"</span>"}else{r+=M[0]}O=P.lR.lastIndex;M=P.lR.exec(L)}return r+L.substr(O,L.length-O)}function J(L,M){if(M.sL&&e[M.sL]){var r=d(M.sL,L);x+=r.keyword_count;return r.value}else{return F(L,M)}}function I(M,r){var L=M.cN?'<span class="'+M.cN+'">':"";if(M.rB){y+=L;M.buffer=""}else{if(M.eB){y+=m(r)+L;M.buffer=""}else{y+=L;M.buffer=r}}D.push(M);A+=M.r}function G(N,M,Q){var R=D[D.length-1];if(Q){y+=J(R.buffer+N,R);return false}var P=q(M,R);if(P){y+=J(R.buffer+N,R);I(P,M);return P.rB}var L=v(D.length-1,M);if(L){var O=R.cN?"</span>":"";if(R.rE){y+=J(R.buffer+N,R)+O}else{if(R.eE){y+=J(R.buffer+N,R)+O+m(M)}else{y+=J(R.buffer+N+M,R)+O}}while(L>1){O=D[D.length-2].cN?"</span>":"";y+=O;L--;D.length--}var r=D[D.length-1];D.length--;D[D.length-1].buffer="";if(r.starts){I(r.starts,"")}return R.rE}if(w(M,R)){throw"Illegal"}}var E=e[B];var D=[E.dM];var A=0;var x=0;var y="";try{var s,u=0;E.dM.buffer="";do{s=p(C,u);var t=G(s[0],s[1],s[2]);u+=s[0].length;if(!t){u+=s[1].length}}while(!s[2]);if(D.length>1){throw"Illegal"}return{r:A,keyword_count:x,value:y}}catch(H){if(H=="Illegal"){return{r:0,keyword_count:0,value:m(C)}}else{throw H}}}function g(t){var p={keyword_count:0,r:0,value:m(t)};var r=p;for(var q in e){if(!e.hasOwnProperty(q)){continue}var s=d(q,t);s.language=q;if(s.keyword_count+s.r>r.keyword_count+r.r){r=s}if(s.keyword_count+s.r>p.keyword_count+p.r){r=p;p=s}}if(r.language){p.second_best=r}return p}function i(r,q,p){if(q){r=r.replace(/^((<[^>]+>|\t)+)/gm,function(t,w,v,u){return w.replace(/\t/g,q)})}if(p){r=r.replace(/\n/g,"<br>")}return r}function n(t,w,r){var x=h(t,r);var v=a(t);var y,s;if(v){y=d(v,x)}else{return}var q=c(t);if(q.length){s=document.createElement("pre");s.innerHTML=y.value;y.value=k(q,c(s),x)}y.value=i(y.value,w,r);var u=t.className;if(!u.match("(\\s|^)(language-)?"+v+"(\\s|$)")){u=u?(u+" "+v):v}if(/MSIE [678]/.test(navigator.userAgent)&&t.tagName=="CODE"&&t.parentNode.tagName=="PRE"){s=t.parentNode;var p=document.createElement("div");p.innerHTML="<pre><code>"+y.value+"</code></pre>";t=p.firstChild.firstChild;p.firstChild.cN=s.cN;s.parentNode.replaceChild(p.firstChild,s)}else{t.innerHTML=y.value}t.className=u;t.result={language:v,kw:y.keyword_count,re:y.r};if(y.second_best){t.second_best={language:y.second_best.language,kw:y.second_best.keyword_count,re:y.second_best.r}}}function o(){if(o.called){return}o.called=true;var r=document.getElementsByTagName("pre");for(var p=0;p<r.length;p++){var q=b(r[p]);if(q){n(q,hljs.tabReplace)}}}function l(){if(window.addEventListener){window.addEventListener("DOMContentLoaded",o,false);window.addEventListener("load",o,false)}else{if(window.attachEvent){window.attachEvent("onload",o)}else{window.onload=o}}}var e={};this.LANGUAGES=e;this.highlight=d;this.highlightAuto=g;this.fixMarkup=i;this.highlightBlock=n;this.initHighlighting=o;this.initHighlightingOnLoad=l;this.IR="[a-zA-Z][a-zA-Z0-9_]*";this.UIR="[a-zA-Z_][a-zA-Z0-9_]*";this.NR="\\b\\d+(\\.\\d+)?";this.CNR="\\b(0[xX][a-fA-F0-9]+|(\\d+(\\.\\d*)?|\\.\\d+)([eE][-+]?\\d+)?)";this.BNR="\\b(0b[01]+)";this.RSR="!|!=|!==|%|%=|&|&&|&=|\\*|\\*=|\\+|\\+=|,|\\.|-|-=|/|/=|:|;|<|<<|<<=|<=|=|==|===|>|>=|>>|>>=|>>>|>>>=|\\?|\\[|\\{|\\(|\\^|\\^=|\\||\\|=|\\|\\||~";this.ER="(?![\\s\\S])";this.BE={b:"\\\\.",r:0};this.ASM={cN:"string",b:"'",e:"'",i:"\\n",c:[this.BE],r:0};this.QSM={cN:"string",b:'"',e:'"',i:"\\n",c:[this.BE],r:0};this.CLCM={cN:"comment",b:"//",e:"$"};this.CBLCLM={cN:"comment",b:"/\\*",e:"\\*/"};this.HCM={cN:"comment",b:"#",e:"$"};this.NM={cN:"number",b:this.NR,r:0};this.CNM={cN:"number",b:this.CNR,r:0};this.BNM={cN:"number",b:this.BNR,r:0};this.inherit=function(r,s){var p={};for(var q in r){p[q]=r[q]}if(s){for(var q in s){p[q]=s[q]}}return p}}();hljs.LANGUAGES.cpp=function(){var a={keyword:{"false":1,"int":1,"float":1,"while":1,"private":1,"char":1,"catch":1,"export":1,virtual:1,operator:2,sizeof:2,dynamic_cast:2,typedef:2,const_cast:2,"const":1,struct:1,"for":1,static_cast:2,union:1,namespace:1,unsigned:1,"long":1,"throw":1,"volatile":2,"static":1,"protected":1,bool:1,template:1,mutable:1,"if":1,"public":1,friend:2,"do":1,"return":1,"goto":1,auto:1,"void":2,"enum":1,"else":1,"break":1,"new":1,extern:1,using:1,"true":1,"class":1,asm:1,"case":1,typeid:1,"short":1,reinterpret_cast:2,"default":1,"double":1,register:1,explicit:1,signed:1,typename:1,"try":1,"this":1,"switch":1,"continue":1,wchar_t:1,inline:1,"delete":1,alignof:1,char16_t:1,char32_t:1,constexpr:1,decltype:1,noexcept:1,nullptr:1,static_assert:1,thread_local:1,restrict:1,_Bool:1,complex:1},built_in:{std:1,string:1,cin:1,cout:1,cerr:1,clog:1,stringstream:1,istringstream:1,ostringstream:1,auto_ptr:1,deque:1,list:1,queue:1,stack:1,vector:1,map:1,set:1,bitset:1,multiset:1,multimap:1,unordered_set:1,unordered_map:1,unordered_multiset:1,unordered_multimap:1,array:1,shared_ptr:1}};return{dM:{k:a,i:"</",c:[hljs.CLCM,hljs.CBLCLM,hljs.QSM,{cN:"string",b:"'\\\\?.",e:"'",i:"."},{cN:"number",b:"\\b(\\d+(\\.\\d*)?|\\.\\d+)(u|U|l|L|ul|UL|f|F)"},hljs.CNM,{cN:"preprocessor",b:"#",e:"$"},{cN:"stl_container",b:"\\b(deque|list|queue|stack|vector|map|set|bitset|multiset|multimap|unordered_map|unordered_set|unordered_multiset|unordered_multimap|array)\\s*<",e:">",k:a,r:10,c:["self"]}]}}}();hljs.LANGUAGES.r={dM:{c:[hljs.HCM,{cN:"number",b:"\\b0[xX][0-9a-fA-F]+[Li]?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+(?:[eE][+\\-]?\\d*)?L\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+\\.(?!\\d)(?:i\\b)?",e:hljs.IMMEDIATE_RE,r:1},{cN:"number",b:"\\b\\d+(?:\\.\\d*)?(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\.\\d+(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"keyword",b:"(?:tryCatch|library|setGeneric|setGroupGeneric)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\.",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\d+(?![\\w.])",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\b(?:function)",e:hljs.IMMEDIATE_RE,r:2},{cN:"keyword",b:"(?:if|in|break|next|repeat|else|for|return|switch|while|try|stop|warning|require|attach|detach|source|setMethod|setClass)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"literal",b:"(?:NA|NA_integer_|NA_real_|NA_character_|NA_complex_)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"literal",b:"(?:NULL|TRUE|FALSE|T|F|Inf|NaN)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"identifier",b:"[a-zA-Z.][a-zA-Z0-9._]*\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"<\\-(?!\\s*\\d)",e:hljs.IMMEDIATE_RE,r:2},{cN:"operator",b:"\\->|<\\-",e:hljs.IMMEDIATE_RE,r:1},{cN:"operator",b:"%%|~",e:hljs.IMMEDIATE_RE},{cN:"operator",b:">=|<=|==|!=|\\|\\||&&|=|\\+|\\-|\\*|/|\\^|>|<|!|&|\\||\\$|:",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"%",e:"%",i:"\\n",r:1},{cN:"identifier",b:"`",e:"`",r:0},{cN:"string",b:'"',e:'"',c:[hljs.BE],r:0},{cN:"string",b:"'",e:"'",c:[hljs.BE],r:0},{cN:"paren",b:"[[({\\])}]",e:hljs.IMMEDIATE_RE,r:0}]}};
hljs.initHighlightingOnLoad();
</script>

<!-- MathJax scripts -->
<script type="text/javascript" src="https://c328740.ssl.cf1.rackcdn.com/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>


<style type="text/css">
body, td {
   font-family: sans-serif;
   background-color: white;
   font-size: 13px;
}

body {
  max-width: 800px;
  margin: auto;
  padding: 1em;
  line-height: 20px;
}

tt, code, pre {
   font-family: 'DejaVu Sans Mono', 'Droid Sans Mono', 'Lucida Console', Consolas, Monaco, monospace;
}

h1 {
   font-size:2.2em;
}

h2 {
   font-size:1.8em;
}

h3 {
   font-size:1.4em;
}

h4 {
   font-size:1.0em;
}

h5 {
   font-size:0.9em;
}

h6 {
   font-size:0.8em;
}

a:visited {
   color: rgb(50%, 0%, 50%);
}

pre, img {
  max-width: 100%;
}

pre code {
   display: block; padding: 0.5em;
}

code {
  font-size: 92%;
  border: 1px solid #ccc;
}

code[class] {
  background-color: #F8F8F8;
}

table, td, th {
  border: none;
}

blockquote {
   color:#666666;
   margin:0;
   padding-left: 1em;
   border-left: 0.5em #EEE solid;
}

hr {
   height: 0px;
   border-bottom: none;
   border-top-width: thin;
   border-top-style: dotted;
   border-top-color: #999999;
}

@media print {
   * {
      background: transparent !important;
      color: black !important;
      filter:none !important;
      -ms-filter: none !important;
   }

   body {
      font-size:12pt;
      max-width:100%;
   }

   a, a:visited {
      text-decoration: underline;
   }

   hr {
      visibility: hidden;
      page-break-before: always;
   }

   pre, blockquote {
      padding-right: 1em;
      page-break-inside: avoid;
   }

   tr, img {
      page-break-inside: avoid;
   }

   img {
      max-width: 100% !important;
   }

   @page :left {
      margin: 15mm 20mm 15mm 10mm;
   }

   @page :right {
      margin: 15mm 10mm 15mm 20mm;
   }

   p, h2, h3 {
      orphans: 3; widows: 3;
   }

   h2, h3 {
      page-break-after: avoid;
   }
}
</style>



</head>

<body>
<h1>Extending R/cape: Multivariant Analysis</h1>

<p>The purpose of this project is to test a new model to extend <code>R/cape</code> for the analysis of more than 2 variants simulataneously.</p>

<p>There are two parts to the code:</p>

<ul>
<li><code>create_data.R</code>, where we fabricate a dataset given an underlying variant-to-variant interaction network, and</li>
<li><code>get_interactions.R</code> where we use our new model on the fabricated marker and phenotype data to re-infer the underlying variant interactions.</li>
</ul>

<p>Using this methodology, we can implement the new model of analysis while testing its robustness as it responds to varying levels of noise that we can systematically introduce into the data.</p>

<hr/>

<h1>Running the code: an example</h1>

<h2>create_data.R</h2>

<p>Here is an example of the data generated by the script <code>create_data.R</code>. We set several parameters in the fabrication of this dataset, most notably</p>

<ul>
<li>1000 individuals,</li>
<li>6 phenotypes,</li>
<li>7 variants,</li>
<li>50% allelic frequency, and</li>
<li><strong>No noise</strong> &ndash; this will be updated shortly</li>
</ul>

<p>Then, using the underlying interaction matrix \(\boldsymbol{A}\), set to</p>

<!-- 

```r
library("MASS")
library("Matrix")
load("~/JAX/simulation/v1.3/bin/full_simulation.RData")
```
 -->

<pre><code class="r">print(dataset$A)
</code></pre>

<pre><code>##      [,1] [,2] [,3] [,4] [,5] [,6] [,7]
## [1,]  0.0  0.4  0.0  0.0  0.0  0.0  0.0
## [2,]  0.4  0.0  0.4  0.0  0.4  0.0  0.0
## [3,]  0.0  0.0  0.0  0.4  0.4  0.4  0.0
## [4,]  0.0  0.0  0.0  0.0  0.0  0.0  0.0
## [5,]  0.0  0.4  0.0  0.4  0.0  0.0  0.0
## [6,]  0.0  0.0  0.0  0.0  0.4  0.0  0.4
## [7,]  0.0  0.0  0.0  0.0  0.0  0.0  0.0
</code></pre>

<p>and the main effect matrix</p>

<pre><code class="r">print(params$ME_betas)
</code></pre>

<pre><code>##          [,1]    [,2]    [,3]     [,4]     [,5]    [,6]
## [1,] -1.38507 -0.2294  0.9588  0.44419 -0.72770  0.3516
## [2,]  0.03832  0.1971  0.9181 -0.20495 -0.86190  0.8788
## [3,] -0.76303  1.2072 -0.1510  1.67563 -0.03752  0.2047
## [4,]  0.21231  0.3183 -1.2231 -0.13132 -1.63142 -0.8874
## [5,]  1.42554 -1.4238 -0.8688 -0.19988  0.17717 -0.4772
## [6,]  0.74448 -0.4051 -1.0425  0.05491 -0.01250 -0.2677
## [7,]  0.70023  0.9954 -1.1036 -0.68217 -0.39432  1.5859
</code></pre>

<p>we created the \(\beta\) matrix.</p>

<pre><code class="r">print(dataset$betas)
</code></pre>

<pre><code>##             [,1]      [,2]      [,3]       [,4]       [,5]       [,6]
##   [1,]  1.000000  1.000000  1.000000  1.0000000  1.0000000  1.0000000
##   [2,] -1.385071 -0.229355  0.958818  0.4441851 -0.7277041  0.3515629
##   [3,]  0.038323  0.197094  0.918088 -0.2049506 -0.8619043  0.8787676
##   [4,] -0.763030  1.207154 -0.150970  1.6756324 -0.0375231  0.2046541
##   [5,]  0.212306  0.318337 -1.223069 -0.1313222 -1.6314232 -0.8873807
##   [6,]  1.425538 -1.423799 -0.868824 -0.1998830  0.1771666 -0.4772161
##   [7,]  0.744480 -0.405091 -1.042485  0.0549124 -0.0125008 -0.2677410
##   [8,]  0.700229  0.995387 -1.103638 -0.6821655 -0.3943171  1.5858592
##   [9,] -0.538699 -0.012904  0.750762  0.0956938 -0.6358434  0.4921322
##  [10,]  0.000000  0.000000  0.000000  0.0000000  0.0000000  0.0000000
##  [11,]  0.000000  0.000000  0.000000  0.0000000  0.0000000  0.0000000
##  [12,]  0.000000  0.000000  0.000000  0.0000000  0.0000000  0.0000000
##  [13,]  0.000000  0.000000  0.000000  0.0000000  0.0000000  0.0000000
##  [14,]  0.000000  0.000000  0.000000  0.0000000  0.0000000  0.0000000
##  [15,] -0.305212  0.482862 -0.060388  0.6702530 -0.0150092  0.0818616
##  [16,]  0.000000  0.000000  0.000000  0.0000000  0.0000000  0.0000000
##  [17,]  0.585544 -0.490682  0.019705 -0.1619334 -0.2738951  0.1606206
##  [18,]  0.000000  0.000000  0.000000  0.0000000  0.0000000  0.0000000
##  [19,]  0.000000  0.000000  0.000000  0.0000000  0.0000000  0.0000000
##  [20,]  0.084922  0.127335 -0.489228 -0.0525289 -0.6525693 -0.3549523
##  [21,]  0.570215 -0.569520 -0.347530 -0.0799532  0.0708666 -0.1908864
##  [22,]  0.297792 -0.162036 -0.416994  0.0219650 -0.0050003 -0.1070964
##  [23,]  0.000000  0.000000  0.000000  0.0000000  0.0000000  0.0000000
##  [24,]  0.084922  0.127335 -0.489228 -0.0525289 -0.6525693 -0.3549523
##  [25,]  0.000000  0.000000  0.000000  0.0000000  0.0000000  0.0000000
##  [26,]  0.000000  0.000000  0.000000  0.0000000  0.0000000  0.0000000
##  [27,]  0.570215 -0.569520 -0.347530 -0.0799532  0.0708666 -0.1908864
##  [28,]  0.000000  0.000000  0.000000  0.0000000  0.0000000  0.0000000
##  [29,]  0.280092  0.398155 -0.441455 -0.2728662 -0.1577269  0.6343437
##  [30,] -0.122085  0.193145 -0.024155  0.2681012 -0.0060037  0.0327447
##  [31,]  0.000000  0.000000  0.000000  0.0000000  0.0000000  0.0000000
##  [32,]  0.006475 -0.264505  0.014399  0.0390883 -0.0880860 -0.0201045
##  [33,]  0.000000  0.000000  0.000000  0.0000000  0.0000000  0.0000000
##  [34,]  0.000000  0.000000  0.000000  0.0000000  0.0000000  0.0000000
##  [35,]  0.000000  0.000000  0.000000  0.0000000  0.0000000  0.0000000
##  [36,]  0.000000  0.000000  0.000000  0.0000000  0.0000000  0.0000000
##  [37,]  0.000000  0.000000  0.000000  0.0000000  0.0000000  0.0000000
##  [38,]  0.000000  0.000000  0.000000  0.0000000  0.0000000  0.0000000
##  [39,]  0.000000  0.000000  0.000000  0.0000000  0.0000000  0.0000000
##  [40,]  0.000000  0.000000  0.000000  0.0000000  0.0000000  0.0000000
##  [41,]  0.000000  0.000000  0.000000  0.0000000  0.0000000  0.0000000
##  [42,]  0.000000  0.000000  0.000000  0.0000000  0.0000000  0.0000000
##  [43,]  0.000000  0.000000  0.000000  0.0000000  0.0000000  0.0000000
##  [44,]  0.000000  0.000000  0.000000  0.0000000  0.0000000  0.0000000
##  [45,]  0.033969  0.050934 -0.195691 -0.0210116 -0.2610277 -0.1419809
##  [46,]  0.112133 -0.003128 -0.016273  0.2033278 -0.1155617  0.0969929
##  [47,]  0.119117 -0.064815 -0.166798  0.0087860 -0.0020001 -0.0428386
##  [48,]  0.000000  0.000000  0.000000  0.0000000  0.0000000  0.0000000
##  [49,]  0.033969  0.050934 -0.195691 -0.0210116 -0.2610277 -0.1419809
##  [50,]  0.000000  0.000000  0.000000  0.0000000  0.0000000  0.0000000
##  [51,]  0.000000  0.000000  0.000000  0.0000000  0.0000000  0.0000000
##  [52,]  0.006132  0.031535  0.146894 -0.0327921 -0.1379047  0.1406028
##  [53,]  0.000000  0.000000  0.000000  0.0000000  0.0000000  0.0000000
##  [54,]  0.000000  0.000000  0.000000  0.0000000  0.0000000  0.0000000
##  [55,]  0.033969  0.050934 -0.195691 -0.0210116 -0.2610277 -0.1419809
##  [56,]  0.000000  0.000000  0.000000  0.0000000  0.0000000  0.0000000
##  [57,]  0.000000  0.000000  0.000000  0.0000000  0.0000000  0.0000000
##  [58,]  0.228086 -0.227808 -0.139012 -0.0319813  0.0283467 -0.0763546
##  [59,]  0.000000  0.000000  0.000000  0.0000000  0.0000000  0.0000000
##  [60,]  0.112037  0.159262 -0.176582 -0.1091465 -0.0630907  0.2537375
##  [61,]  0.033969  0.050934 -0.195691 -0.0210116 -0.2610277 -0.1419809
##  [62,]  0.000000  0.000000  0.000000  0.0000000  0.0000000  0.0000000
##  [63,]  0.000000  0.000000  0.000000  0.0000000  0.0000000  0.0000000
##  [64,]  0.000000  0.000000  0.000000  0.0000000  0.0000000  0.0000000
##  [65,]  0.013588  0.020374 -0.078276 -0.0084046 -0.1044111 -0.0567924
##  [66,]  0.098730 -0.171697  0.067670 -0.0233909 -0.1342195  0.0738986
##  [67,]  0.047647 -0.025926 -0.066719  0.0035144 -0.0008001 -0.0171354
##  [68,]  0.000000  0.000000  0.000000  0.0000000  0.0000000  0.0000000
##  [69,]  0.018493  0.045602  0.039239 -0.0346383 -0.2147348  0.0556899
##  [70,]  0.000000  0.000000  0.000000  0.0000000  0.0000000  0.0000000
##  [71,]  0.000000  0.000000  0.000000  0.0000000  0.0000000  0.0000000
##  [72,]  0.007495 -0.080574  0.123275 -0.0105983 -0.1455582  0.1044404
##  [73,]  0.004905  0.025228  0.117515 -0.0262337 -0.1103237  0.1124822
##  [74,]  0.000000  0.000000  0.000000  0.0000000  0.0000000  0.0000000
##  [75,]  0.000000  0.000000  0.000000  0.0000000  0.0000000  0.0000000
##  [76,]  0.000000  0.000000  0.000000  0.0000000  0.0000000  0.0000000
##  [77,]  0.000000  0.000000  0.000000  0.0000000  0.0000000  0.0000000
##  [78,]  0.000000  0.000000  0.000000  0.0000000  0.0000000  0.0000000
##  [79,]  0.000000  0.000000  0.000000  0.0000000  0.0000000  0.0000000
##  [80,]  0.000000  0.000000  0.000000  0.0000000  0.0000000  0.0000000
##  [81,]  0.000000  0.000000  0.000000  0.0000000  0.0000000  0.0000000
##  [82,]  0.000000  0.000000  0.000000  0.0000000  0.0000000  0.0000000
##  [83,]  0.000000  0.000000  0.000000  0.0000000  0.0000000  0.0000000
##  [84,]  0.000000  0.000000  0.000000  0.0000000  0.0000000  0.0000000
##  [85,]  0.118410 -0.050376 -0.212158 -0.0296018 -0.1974835 -0.1441266
##  [86,]  0.000000  0.000000  0.000000  0.0000000  0.0000000  0.0000000
##  [87,]  0.000000  0.000000  0.000000  0.0000000  0.0000000  0.0000000
##  [88,]  0.274969 -0.209423 -0.184438  0.0592605 -0.0243474 -0.0394219
##  [89,]  0.091234 -0.091123 -0.055605 -0.0127925  0.0113387 -0.0305418
##  [90,]  0.044815  0.063705 -0.070633 -0.0436586 -0.0252363  0.1014950
##  [91,]  0.091234 -0.091123 -0.055605 -0.0127925  0.0113387 -0.0305418
##  [92,]  0.000000  0.000000  0.000000  0.0000000  0.0000000  0.0000000
##  [93,]  0.000000  0.000000  0.000000  0.0000000  0.0000000  0.0000000
##  [94,]  0.091234 -0.091123 -0.055605 -0.0127925  0.0113387 -0.0305418
##  [95,]  0.013588  0.020374 -0.078276 -0.0084046 -0.1044111 -0.0567924
##  [96,]  0.000000  0.000000  0.000000  0.0000000  0.0000000  0.0000000
##  [97,]  0.000000  0.000000  0.000000  0.0000000  0.0000000  0.0000000
##  [98,]  0.000000  0.000000  0.000000  0.0000000  0.0000000  0.0000000
##  [99,]  0.000000  0.000000  0.000000  0.0000000  0.0000000  0.0000000
## [100,] -0.024218  0.050921  0.002462  0.0695826 -0.1657381  0.0293170
## [101,]  0.000000  0.000000  0.000000  0.0000000  0.0000000  0.0000000
## [102,]  0.000000  0.000000  0.000000  0.0000000  0.0000000  0.0000000
## [103,]  0.040898 -0.070506  0.069909  0.0618330 -0.1313615  0.0920936
## [104,] -0.035088  0.034622  0.065083  0.0763063 -0.0822092  0.0747509
## [105,]  0.017926  0.025482 -0.028253 -0.0174634 -0.0100945  0.0405980
## [106,]  0.008433 -0.024080  0.017999 -0.0076012 -0.0999877  0.0190592
## [107,]  0.001036 -0.042321  0.002304  0.0062541 -0.0140938 -0.0032167
## [108,]  0.000000  0.000000  0.000000  0.0000000  0.0000000  0.0000000
## [109,]  0.002998 -0.032230  0.049310 -0.0042393 -0.0582233  0.0417762
## [110,]  0.000000  0.000000  0.000000  0.0000000  0.0000000  0.0000000
## [111,]  0.000000  0.000000  0.000000  0.0000000  0.0000000  0.0000000
## [112,]  0.000000  0.000000  0.000000  0.0000000  0.0000000  0.0000000
## [113,]  0.000000  0.000000  0.000000  0.0000000  0.0000000  0.0000000
## [114,]  0.000000  0.000000  0.000000  0.0000000  0.0000000  0.0000000
## [115,]  0.096690 -0.030210 -0.122720 -0.0341749 -0.2021163 -0.0703083
## [116,]  0.006416  0.013195 -0.007808 -0.0086086 -0.0638292 -0.0002205
## [117,]  0.000000  0.000000  0.000000  0.0000000  0.0000000  0.0000000
## [118,]  0.092876 -0.037325 -0.025731 -0.0381909 -0.0451531  0.0611574
## [119,]  0.006416  0.013195 -0.007808 -0.0086086 -0.0638292 -0.0002205
## [120,]  0.000000  0.000000  0.000000  0.0000000  0.0000000  0.0000000
## [121,]  0.038058 -0.036417 -0.058833  0.0378524 -0.1735204 -0.0146457
## [122,]  0.029517 -0.036839 -0.036267  0.0098366 -0.0758000 -0.0195143
## [123,]  0.000000  0.000000  0.000000  0.0000000  0.0000000  0.0000000
## [124,]  0.025014 -0.055976  0.016312  0.0459209 -0.0732858  0.0398750
## [125,]  0.003788 -0.026560  0.008121 -0.0005388 -0.0456326  0.0063370
## [126,]  0.000000  0.000000  0.000000  0.0000000  0.0000000  0.0000000
## [127,]  0.026514 -0.006242 -0.025585  0.0061780 -0.0478192 -0.0078541
## [128,]  0.035538 -0.010164 -0.039586  0.0087634 -0.1047322  0.0066976
</code></pre>

<p>Now, using the linear regression model
\[
Y \sim X \cdot \beta + \epsilon,
\]
where \(Y\) is the phenotype matrix (columns represent phenotypes, rows invididuals), \(X\) is the genotype matrix, and \(\beta\) is the weights matrix, we get the following fabricated data:</p>

<!-- colnames(X) <- c("x0", "x1", "x2", "x3", "x4", "x12", "x13", "x14", "x23", "x24", "x34", 
                 "x123", "x124", "x134", "x234", "x1234") -->

<pre><code class="r">colnames(X) &lt;- c(&quot;x0&quot;, &quot;x1&quot;, &quot;x2&quot;, &quot;x3&quot;, &quot;x12&quot;, &quot;x13&quot;, &quot;x23&quot;, &quot;x123&quot;)
</code></pre>

<pre><code>## Error: length of &#39;dimnames&#39; [2] not equal to array extent
</code></pre>

<pre><code class="r">head(X)
</code></pre>

<pre><code>##      [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10] [,11] [,12] [,13]
## [1,]    1    0    1    1    0    1    2    2    0     0     0     0     0
## [2,]    1    0    1    1    1    0    1    0    0     0     0     0     0
## [3,]    1    0    0    1    1    0    2    0    0     0     0     0     0
## [4,]    1    2    2    1    1    2    1    2    4     2     2     4     2
## [5,]    1    1    1    0    1    1    1    1    1     0     1     1     1
## [6,]    1    1    2    1    2    0    1    0    2     1     2     0     1
##      [,14] [,15] [,16] [,17] [,18] [,19] [,20] [,21] [,22] [,23] [,24]
## [1,]     0     1     0     1     2     2     0     1     2     2     0
## [2,]     0     1     1     0     1     0     1     0     1     0     0
## [3,]     0     0     0     0     0     0     1     0     2     0     0
## [4,]     4     2     2     4     2     4     1     2     1     2     2
## [5,]     1     0     1     1     1     1     0     0     0     0     1
## [6,]     0     2     4     0     2     0     2     0     1     0     0
##      [,25] [,26] [,27] [,28] [,29] [,30] [,31] [,32] [,33] [,34] [,35]
## [1,]     0     0     2     2     4     0     0     0     0     0     0
## [2,]     1     0     0     0     0     0     0     0     0     0     0
## [3,]     2     0     0     0     0     0     0     0     0     0     0
## [4,]     1     2     2     4     2     4     4     8     4     8     2
## [5,]     1     1     1     1     1     0     1     1     1     1     0
## [6,]     2     0     0     0     0     2     4     0     2     0     2
##      [,36] [,37] [,38] [,39] [,40] [,41] [,42] [,43] [,44] [,45] [,46]
## [1,]     0     0     0     0     0     0     0     0     0     0     1
## [2,]     0     0     0     0     0     0     0     0     0     1     0
## [3,]     0     0     0     0     0     0     0     0     0     0     0
## [4,]     4     2     4     4     2     4     4     8     4     2     4
## [5,]     0     0     0     1     1     1     1     1     1     0     0
## [6,]     0     1     0     0     2     0     0     0     0     4     0
##      [,47] [,48] [,49] [,50] [,51] [,52] [,53] [,54] [,55] [,56] [,57]
## [1,]     2     2     0     0     0     2     2     4     0     0     0
## [2,]     1     0     0     1     0     0     0     0     0     1     0
## [3,]     0     0     0     0     0     0     0     0     0     2     0
## [4,]     2     4     4     2     4     4     8     4     2     1     2
## [5,]     0     0     1     1     1     1     1     1     0     0     0
## [6,]     2     0     0     4     0     0     0     0     0     2     0
##      [,58] [,59] [,60] [,61] [,62] [,63] [,64] [,65] [,66] [,67] [,68]
## [1,]     2     2     4     0     0     0     4     0     0     0     0
## [2,]     0     0     0     0     0     0     0     0     0     0     0
## [3,]     0     0     0     0     0     0     0     0     0     0     0
## [4,]     2     4     2     2     4     2     4     4     8     4     8
## [5,]     0     0     0     1     1     1     1     0     0     0     0
## [6,]     0     0     0     0     0     0     0     4     0     2     0
##      [,69] [,70] [,71] [,72] [,73] [,74] [,75] [,76] [,77] [,78] [,79]
## [1,]     0     0     0     0     0     0     0     0     0     0     0
## [2,]     0     0     0     0     0     0     0     0     0     0     0
## [3,]     0     0     0     0     0     0     0     0     0     0     0
## [4,]     8     4     8     8    16     8     4     2     4     4     8
## [5,]     1     1     1     1     1     1     0     0     0     0     0
## [6,]     0     4     0     0     0     0     0     2     0     0     0
##      [,80] [,81] [,82] [,83] [,84] [,85] [,86] [,87] [,88] [,89] [,90]
## [1,]     0     0     0     0     0     0     0     0     2     2     4
## [2,]     0     0     0     0     0     0     1     0     0     0     0
## [3,]     0     0     0     0     0     0     0     0     0     0     0
## [4,]     4     4     8     4     8     4     2     4     4     8     4
## [5,]     0     1     1     1     1     0     0     0     0     0     0
## [6,]     0     0     0     0     0     0     4     0     0     0     0
##      [,91] [,92] [,93] [,94] [,95] [,96] [,97] [,98] [,99] [,100] [,101]
## [1,]     0     0     0     4     0     0     0     4     0      0      0
## [2,]     0     0     0     0     0     0     0     0     0      0      0
## [3,]     0     0     0     0     0     0     0     0     0      0      0
## [4,]     4     8     4     8     2     4     2     4     4      8      4
## [5,]     1     1     1     1     0     0     0     0     1      0      0
## [6,]     0     0     0     0     0     0     0     0     0      0      4
##      [,102] [,103] [,104] [,105] [,106] [,107] [,108] [,109] [,110] [,111]
## [1,]      0      0      0      0      0      0      0      0      0      0
## [2,]      0      0      0      0      0      0      0      0      0      0
## [3,]      0      0      0      0      0      0      0      0      0      0
## [4,]      8      8     16      8      8     16      8     16      4      8
## [5,]      0      0      0      0      1      1      1      1      0      0
## [6,]      0      0      0      0      0      0      0      0      0      0
##      [,112] [,113] [,114] [,115] [,116] [,117] [,118] [,119] [,120] [,121]
## [1,]      0      0      0      0      0      0      4      0      0      0
## [2,]      0      0      0      0      0      0      0      0      0      0
## [3,]      0      0      0      0      0      0      0      0      0      0
## [4,]      4      8      8      4      8      4      8      8      4      8
## [5,]      0      0      1      0      0      0      0      1      0      0
## [6,]      0      0      0      0      0      0      0      0      0      0
##      [,122] [,123] [,124] [,125] [,126] [,127] [,128]
## [1,]      0      0      0      0      0      0      0
## [2,]      0      0      0      0      0      0      0
## [3,]      0      0      0      0      0      0      0
## [4,]     16      8     16     16      8      8     16
## [5,]      0      0      0      1      0      0      0
## [6,]      0      0      0      0      0      0      0
</code></pre>

<pre><code class="r">head(Y)
</code></pre>

<pre><code>##        [,1]    [,2]   [,3]    [,4]    [,5]    [,6]
## [1,] 11.212  0.9649 -9.205 -0.3936  -2.106  7.7787
## [2,]  1.463  2.7518 -1.828  3.0217  -2.479  0.3633
## [3,]  2.619  1.5186 -3.782  2.6455  -1.357 -0.7874
## [4,] 15.041 -9.3431 -5.136  4.5634 -35.980 12.7491
## [5,]  4.034 -0.5301 -1.860 -0.3383  -5.578  3.0369
## [6,] -0.843  4.1262 -1.471  4.3941  -8.856  0.7527
</code></pre>

<hr/>

<h2>get_interactions.R</h2>

<!-- 
__TODO: there is currently a problem with delta matrix $\boldsymbol{I}$ generation involving routing and feedback.__ The part in `helper_fn.R` in the `get.I.from.A` method:
```
...
  active_vars <- A[combo,combo]
  routes <- active_vars %^% (k-1) #routes of length k-1
  diag(routes) <- 0
  delta_row <- colSums(routes) 
...
``` -->

<p>To infer the values of the interactions from the marker data \(X\) and phenotype data \(Y\), we first find the weights \(\beta\) of our linear regression model. Since</p>

<p>\[\beta \approx X^{-1} \cdot Y,\]</p>

<p>in <code>R</code> we do:</p>

<pre><code class="r">ginv(X) %*% Y
</code></pre>

<pre><code>##              [,1]       [,2]       [,3]       [,4]       [,5]       [,6]
##   [1,]  1.000e+00  1.000e+00  1.000e+00  1.000e+00  1.000e+00  1.000e+00
##   [2,] -1.385e+00 -2.294e-01  9.588e-01  4.442e-01 -7.277e-01  3.516e-01
##   [3,]  3.832e-02  1.971e-01  9.181e-01 -2.050e-01 -8.619e-01  8.788e-01
##   [4,] -7.630e-01  1.207e+00 -1.510e-01  1.676e+00 -3.752e-02  2.047e-01
##   [5,]  2.123e-01  3.183e-01 -1.223e+00 -1.313e-01 -1.631e+00 -8.874e-01
##   [6,]  1.426e+00 -1.424e+00 -8.688e-01 -1.999e-01  1.772e-01 -4.772e-01
##   [7,]  7.445e-01 -4.051e-01 -1.042e+00  5.491e-02 -1.250e-02 -2.677e-01
##   [8,]  7.002e-01  9.954e-01 -1.104e+00 -6.822e-01 -3.943e-01  1.586e+00
##   [9,] -5.387e-01 -1.290e-02  7.508e-01  9.569e-02 -6.358e-01  4.921e-01
##  [10,]  2.204e-14 -3.678e-14  1.998e-15  2.444e-14 -1.673e-13  6.913e-14
##  [11,]  5.318e-14  2.123e-14 -9.592e-14  3.698e-14 -1.300e-13  2.390e-14
##  [12,]  1.033e-14  1.586e-14 -1.142e-13  4.227e-14 -1.004e-13  3.561e-14
##  [13,]  3.531e-14  9.048e-15 -8.393e-14  3.506e-14 -9.220e-14  1.558e-14
##  [14,]  6.117e-14  1.055e-14 -1.342e-13  5.506e-14 -1.511e-13  4.881e-14
##  [15,] -3.052e-01  4.829e-01 -6.039e-02  6.703e-01 -1.501e-02  8.186e-02
##  [16,]  2.431e-14  1.088e-14 -5.196e-14  2.959e-14 -8.582e-14  1.513e-14
##  [17,]  5.855e-01 -4.907e-01  1.971e-02 -1.619e-01 -2.739e-01  1.606e-01
##  [18,]  4.027e-14  7.647e-15 -7.838e-14  3.324e-14 -8.329e-14  2.100e-14
##  [19,]  3.803e-14  2.362e-14 -8.449e-14  3.438e-14 -1.072e-13  2.728e-14
##  [20,]  8.492e-02  1.273e-01 -4.892e-01 -5.253e-02 -6.526e-01 -3.550e-01
##  [21,]  5.702e-01 -5.695e-01 -3.475e-01 -7.995e-02  7.087e-02 -1.909e-01
##  [22,]  2.978e-01 -1.620e-01 -4.170e-01  2.196e-02 -5.000e-03 -1.071e-01
##  [23,]  6.928e-14 -2.739e-14 -6.306e-14  2.501e-14 -2.354e-13  8.632e-14
##  [24,]  8.492e-02  1.273e-01 -4.892e-01 -5.253e-02 -6.526e-01 -3.550e-01
##  [25,]  3.203e-14 -2.567e-15 -7.638e-14  2.373e-14 -1.045e-13  1.528e-14
##  [26,]  4.496e-14  6.273e-15 -1.195e-13  4.261e-14 -1.820e-13  4.072e-14
##  [27,]  5.702e-01 -5.695e-01 -3.475e-01 -7.995e-02  7.087e-02 -1.909e-01
##  [28,]  7.860e-14  2.687e-14 -1.671e-13  4.759e-14 -1.753e-13  6.545e-14
##  [29,]  2.801e-01  3.982e-01 -4.415e-01 -2.729e-01 -1.577e-01  6.343e-01
##  [30,] -1.221e-01  1.931e-01 -2.416e-02  2.681e-01 -6.004e-03  3.274e-02
##  [31,] -3.603e-14 -4.330e-15  5.990e-14 -1.444e-14  5.329e-14 -1.785e-14
##  [32,]  6.475e-03 -2.645e-01  1.440e-02  3.909e-02 -8.809e-02 -2.010e-02
##  [33,] -2.504e-14 -6.606e-15  5.396e-14 -3.201e-14  5.904e-14 -1.470e-14
##  [34,] -4.852e-14 -1.082e-14  8.493e-14 -2.752e-14  9.825e-14 -2.071e-14
##  [35,] -1.682e-14 -2.526e-15  2.298e-14 -2.238e-14  7.983e-14 -1.689e-14
##  [36,] -1.027e-14  1.538e-14 -4.619e-14 -1.451e-14  1.058e-13 -5.203e-14
##  [37,] -3.697e-14  3.882e-14 -3.270e-14 -1.338e-14  1.685e-13 -6.474e-14
##  [38,] -5.185e-14  1.915e-14  4.208e-14 -3.764e-14  1.881e-13 -7.232e-14
##  [39,] -2.895e-14 -1.120e-14  9.714e-14 -3.279e-14  7.672e-14 -1.697e-14
##  [40,] -2.964e-14 -1.180e-15  7.572e-14 -2.992e-14  1.011e-13 -1.258e-14
##  [41,] -4.807e-14  4.025e-15  9.859e-14 -3.579e-14  1.313e-13 -3.615e-14
##  [42,] -2.917e-14 -7.438e-15  9.892e-14 -2.680e-14  8.876e-14 -1.939e-14
##  [43,] -3.819e-14 -1.266e-14  1.240e-13 -4.716e-14  1.464e-13 -4.070e-14
##  [44,] -3.270e-14 -1.180e-15  7.577e-14 -2.678e-14  7.949e-14 -2.166e-14
##  [45,]  3.397e-02  5.093e-02 -1.957e-01 -2.101e-02 -2.610e-01 -1.420e-01
##  [46,]  1.121e-01 -3.128e-03 -1.627e-02  2.033e-01 -1.156e-01  9.699e-02
##  [47,]  1.191e-01 -6.481e-02 -1.668e-01  8.786e-03 -2.000e-03 -4.284e-02
##  [48,] -4.058e-14  2.529e-14  2.442e-14 -1.918e-14  1.361e-13 -4.756e-14
##  [49,]  3.397e-02  5.093e-02 -1.957e-01 -2.101e-02 -2.610e-01 -1.420e-01
##  [50,] -3.098e-14 -2.179e-15  5.623e-14 -2.499e-14  7.283e-14 -1.707e-14
##  [51,] -2.387e-14 -5.038e-15  6.684e-14 -3.192e-14  8.871e-14 -1.790e-14
##  [52,]  6.132e-03  3.154e-02  1.469e-01 -3.279e-02 -1.379e-01  1.406e-01
##  [53,] -4.391e-14 -1.373e-14  5.845e-14 -2.860e-14  1.023e-13 -3.074e-14
##  [54,] -3.261e-14 -4.968e-15  6.117e-14 -3.534e-14  8.171e-14 -2.467e-14
##  [55,]  3.397e-02  5.093e-02 -1.957e-01 -2.101e-02 -2.610e-01 -1.420e-01
##  [56,] -1.582e-14  8.465e-15  2.032e-14 -1.715e-14  7.128e-14 -1.757e-14
##  [57,] -5.451e-14 -3.997e-15  6.928e-14 -2.649e-14  1.633e-13 -3.422e-14
##  [58,]  2.281e-01 -2.278e-01 -1.390e-01 -3.198e-02  2.835e-02 -7.635e-02
##  [59,] -5.018e-14  6.106e-15  3.952e-14 -1.716e-14  1.569e-13 -6.789e-14
##  [60,]  1.120e-01  1.593e-01 -1.766e-01 -1.091e-01 -6.309e-02  2.537e-01
##  [61,]  3.397e-02  5.093e-02 -1.957e-01 -2.101e-02 -2.610e-01 -1.420e-01
##  [62,] -5.707e-14 -8.826e-15  1.232e-13 -4.092e-14  1.578e-13 -4.921e-14
##  [63,] -3.517e-14 -1.055e-15  4.891e-14 -2.160e-14  1.011e-13 -2.214e-14
##  [64,] -7.783e-14 -2.251e-14  1.671e-13 -4.557e-14  1.928e-13 -5.938e-14
##  [65,]  1.359e-02  2.037e-02 -7.828e-02 -8.405e-03 -1.044e-01 -5.679e-02
##  [66,]  9.873e-02 -1.717e-01  6.767e-02 -2.339e-02 -1.342e-01  7.390e-02
##  [67,]  4.765e-02 -2.593e-02 -6.672e-02  3.514e-03 -8.001e-04 -1.714e-02
##  [68,]  1.954e-14 -2.510e-14 -4.163e-15  1.714e-14 -9.531e-14  4.467e-14
##  [69,]  1.849e-02  4.560e-02  3.924e-02 -3.464e-02 -2.147e-01  5.569e-02
##  [70,]  2.426e-14  2.762e-15 -4.202e-14  1.949e-14 -6.459e-14  1.108e-14
##  [71,]  3.414e-14  1.071e-14 -7.166e-14  1.799e-14 -7.444e-14  2.395e-14
##  [72,]  7.495e-03 -8.057e-02  1.233e-01 -1.060e-02 -1.456e-01  1.044e-01
##  [73,]  4.905e-03  2.523e-02  1.175e-01 -2.623e-02 -1.103e-01  1.125e-01
##  [74,]  2.673e-14  5.385e-15 -5.418e-14  2.384e-14 -7.894e-14  1.354e-14
##  [75,] -7.938e-15  1.041e-15  1.199e-14  1.834e-14 -1.976e-14  4.025e-16
##  [76,]  4.219e-15  5.246e-15 -9.881e-15  1.483e-14 -6.867e-14  2.137e-14
##  [77,]  3.253e-14 -1.435e-14 -6.173e-14  4.066e-14 -9.892e-14  3.933e-14
##  [78,]  9.048e-15 -2.705e-14  4.891e-14  9.735e-15 -9.864e-14  5.154e-14
##  [79,]  1.255e-14 -1.715e-14 -3.986e-14  2.039e-14 -1.174e-13  4.592e-14
##  [80,]  5.324e-14 -2.906e-14 -1.643e-14  1.626e-14 -1.607e-13  6.561e-14
##  [81,]  2.986e-14  5.523e-15 -4.657e-14  2.594e-14 -6.106e-14  7.376e-15
##  [82,]  4.988e-14  6.189e-15 -1.098e-13  2.698e-14 -1.248e-13  3.588e-14
##  [83,]  2.898e-14 -8.687e-15 -5.879e-14  3.039e-14 -6.897e-14  1.849e-14
##  [84,]  6.978e-14  1.547e-14 -1.356e-13  3.778e-14 -1.554e-13  3.765e-14
##  [85,]  1.184e-01 -5.038e-02 -2.122e-01 -2.960e-02 -1.975e-01 -1.441e-01
##  [86,]  1.060e-14 -1.135e-14  4.996e-15  1.418e-14 -5.435e-14  1.217e-14
##  [87,]  3.014e-14 -4.524e-15 -3.886e-14  1.284e-14 -7.672e-14  1.793e-14
##  [88,]  2.750e-01 -2.094e-01 -1.844e-01  5.926e-02 -2.435e-02 -3.942e-02
##  [89,]  9.123e-02 -9.112e-02 -5.560e-02 -1.279e-02  1.134e-02 -3.054e-02
##  [90,]  4.481e-02  6.370e-02 -7.063e-02 -4.366e-02 -2.524e-02  1.015e-01
##  [91,]  9.123e-02 -9.112e-02 -5.560e-02 -1.279e-02  1.134e-02 -3.054e-02
##  [92,]  1.643e-14  1.046e-14 -6.461e-14  2.008e-14 -7.161e-14  2.454e-14
##  [93,]  3.120e-14  1.138e-15 -4.616e-14  2.576e-14 -6.412e-14  1.651e-14
##  [94,]  9.123e-02 -9.112e-02 -5.560e-02 -1.279e-02  1.134e-02 -3.054e-02
##  [95,]  1.359e-02  2.037e-02 -7.828e-02 -8.405e-03 -1.044e-01 -5.679e-02
##  [96,]  9.437e-15  2.082e-15 -4.818e-14  2.465e-14 -8.682e-14  2.476e-14
##  [97,]  3.564e-14 -3.331e-15 -4.696e-14  2.195e-14 -1.101e-13  2.304e-14
##  [98,]  3.947e-14 -1.091e-14 -3.419e-14  1.547e-14 -1.579e-13  6.238e-14
##  [99,]  6.772e-14  2.554e-15 -1.250e-13  3.350e-14 -1.593e-13  3.693e-14
## [100,] -2.422e-02  5.092e-02  2.462e-03  6.958e-02 -1.657e-01  2.932e-02
## [101,] -5.329e-15  3.150e-15 -1.227e-14 -6.634e-15  5.429e-14 -1.462e-14
## [102,] -1.493e-14  3.497e-15  2.554e-14 -5.784e-15  5.707e-14 -1.345e-14
## [103,]  4.090e-02 -7.051e-02  6.991e-02  6.183e-02 -1.314e-01  9.209e-02
## [104,] -3.509e-02  3.462e-02  6.508e-02  7.631e-02 -8.221e-02  7.475e-02
## [105,]  1.793e-02  2.548e-02 -2.825e-02 -1.746e-02 -1.009e-02  4.060e-02
## [106,]  8.433e-03 -2.408e-02  1.800e-02 -7.601e-03 -9.999e-02  1.906e-02
## [107,]  1.036e-03 -4.232e-02  2.304e-03  6.254e-03 -1.409e-02 -3.217e-03
## [108,] -2.276e-14 -7.133e-15  4.441e-14 -1.659e-14  5.734e-14 -1.472e-14
## [109,]  2.998e-03 -3.223e-02  4.931e-02 -4.239e-03 -5.822e-02  4.178e-02
## [110,]  1.010e-14  1.403e-14 -1.238e-14 -1.383e-14 -2.942e-15 -4.705e-15
## [111,] -1.038e-14  4.052e-15  3.653e-14 -2.301e-14  6.162e-14 -1.991e-14
## [112,] -3.120e-14 -1.943e-15  3.686e-14 -2.718e-14  1.265e-13 -3.220e-14
## [113,] -3.741e-14  1.676e-14  6.217e-15 -1.112e-14  1.206e-13 -5.811e-14
## [114,] -4.552e-14 -1.311e-14  8.776e-14 -3.980e-14  1.163e-13 -3.151e-14
## [115,]  9.669e-02 -3.021e-02 -1.227e-01 -3.417e-02 -2.021e-01 -7.031e-02
## [116,]  6.416e-03  1.320e-02 -7.808e-03 -8.609e-03 -6.383e-02 -2.205e-04
## [117,] -2.487e-14  5.440e-15 -2.554e-15 -1.403e-14  6.123e-14 -1.824e-14
## [118,]  9.288e-02 -3.733e-02 -2.573e-02 -3.819e-02 -4.515e-02  6.116e-02
## [119,]  6.416e-03  1.320e-02 -7.808e-03 -8.609e-03 -6.383e-02 -2.205e-04
## [120,] -3.142e-14  7.744e-15  4.186e-14 -1.143e-14  8.760e-14 -2.161e-14
## [121,]  3.806e-02 -3.642e-02 -5.883e-02  3.785e-02 -1.735e-01 -1.465e-02
## [122,]  2.952e-02 -3.684e-02 -3.627e-02  9.837e-03 -7.580e-02 -1.951e-02
## [123,]  7.161e-15 -5.787e-15 -8.660e-15  1.270e-14 -5.590e-14  1.690e-14
## [124,]  2.501e-02 -5.598e-02  1.631e-02  4.592e-02 -7.329e-02  3.987e-02
## [125,]  3.788e-03 -2.656e-02  8.121e-03 -5.388e-04 -4.563e-02  6.337e-03
## [126,]  1.638e-14 -3.608e-16 -2.720e-14  2.659e-14 -6.056e-14  1.751e-14
## [127,]  2.651e-02 -6.242e-03 -2.559e-02  6.178e-03 -4.782e-02 -7.854e-03
## [128,]  3.554e-02 -1.016e-02 -3.959e-02  8.763e-03 -1.047e-01  6.698e-03
</code></pre>

<p>Notice that these values are essentially equal to the original \(\beta\) values. That&#39;s because we didn&#39;t add any noise to the data yet.</p>

<p>Continuing, we want to find the interaction matrix \(\boldsymbol{A}\) filled with \(\delta\)&#39;s that best fits the following system by the least squares criterion.</p>

<p>\[\begin{cases} 
  \beta_{12}^1 = \beta_{1}^1\delta_{21} + \beta_{2}^1\delta_{12} \\ 
  \beta_{12}^2 = \beta_{1}^2\delta_{21} + \beta_{2}^2\delta_{12} \\ 
  \ldots \\ 
  \beta_{123}^2 = \beta_{1}^2(\delta_{21} + \delta_{31} + \delta_{23}\delta_{31} + \delta_{32}\delta_{21}) + \beta_{2}^2(\delta_{12} + \delta_{32} + \delta_{13}\delta_{32} + \delta_{31}\delta_{12}) \\ 
  \beta_{123}^3 = \beta_{1}^3(\delta_{21} + \delta_{31} + \delta_{23}\delta_{31} + \delta_{32}\delta_{21}) + \beta_{2}^3(\delta_{12} + \delta_{32} + \delta_{13}\delta_{32} + \delta_{31}\delta_{12})
\end{cases}\]
<strong>Note:</strong> Example system of equations above is for the 3 variant 3 phenotype case.</p>

<p>Enumerating all the cases, we see that we have 720 equations and 42 variables. (In general, we will have \(p (2^v - v - 1)\) equations and \(2{v \choose 2}\) variables.)</p>

<p>Now, our task is to find the best \(\delta\)&#39;s to fit the equations. We use a series of four optimization algorithms to look for the minima: </p>

<ul>
<li>BFGS, a gradient search method, </li>
<li>Levenberg-Marquardt, a hybrid between gradient descent and Newton&#39;s method, </li>
<li>Nelder-Mead, a simplex method, and </li>
<li>Simulated Annealing, an entropy-based random global search method.</li>
</ul>

<p>We show the results for each here:</p>

<pre><code>solve.bfgs &lt;- bfgs()
</code></pre>

<pre><code class="r">print(solve.bfgs)
</code></pre>

<pre><code>## $par
##  [1]  4.000e-01  6.724e-08  2.963e-08  7.093e-08  1.525e-08 -1.827e-08
##  [7]  4.000e-01 -5.170e-08  4.005e-08  4.000e-01  5.953e-08  6.197e-08
## [13] -2.556e-08  4.000e-01 -5.639e-09  1.845e-08 -2.839e-08  5.104e-08
## [19]  1.671e-08  3.277e-08  4.000e-01  4.000e-01  4.767e-08  2.264e-08
## [25]  8.068e-08  4.000e-01  4.000e-01 -5.103e-08  4.000e-01  2.841e-08
## [31]  4.262e-08  2.487e-08  4.000e-01 -9.992e-09 -2.226e-07 -1.941e-08
## [37] -7.963e-09  2.131e-08  6.546e-09 -4.257e-08  4.480e-08  4.000e-01
## 
## $value
## [1] 1.193e-12
## 
## $counts
## function gradient 
##      195      100 
## 
## $convergence
## [1] 1
## 
## $message
## NULL
</code></pre>

<pre><code class="r">signif(reshape.with.diag(solve.bfgs$par, n_v), digits=4)
</code></pre>

<pre><code>##            [,1]       [,2]       [,3]      [,4]       [,5]       [,6]
## [1,]  0.000e+00  4.000e-01 -2.556e-08 1.671e-08  8.068e-08  4.262e-08
## [2,]  4.000e-01  0.000e+00  4.000e-01 3.277e-08  4.000e-01  2.487e-08
## [3,]  6.724e-08 -5.170e-08  0.000e+00 4.000e-01  4.000e-01  4.000e-01
## [4,]  2.963e-08  4.005e-08 -5.639e-09 0.000e+00 -5.103e-08 -9.992e-09
## [5,]  7.093e-08  4.000e-01  1.845e-08 4.000e-01  0.000e+00 -2.226e-07
## [6,]  1.525e-08  5.953e-08 -2.839e-08 4.767e-08  4.000e-01  0.000e+00
## [7,] -1.827e-08  6.197e-08  5.104e-08 2.264e-08  2.841e-08 -1.941e-08
##            [,7]
## [1,] -7.963e-09
## [2,]  2.131e-08
## [3,]  6.546e-09
## [4,] -4.257e-08
## [5,]  4.480e-08
## [6,]  4.000e-01
## [7,]  0.000e+00
</code></pre>

<pre><code>solve.lev.marq &lt;- lev.marq()
</code></pre>

<pre><code class="r">print(solve.lev.marq)
</code></pre>

<pre><code>## Nonlinear regression via the Levenberg-Marquardt algorithm
## parameter estimates: 0.400000000275093, -6.24175702374109e-12, -3.31740101409274e-11, -7.53121401136829e-10, 1.69175850682823e-10, 1.21695902030292e-10, 0.400000000086089, -8.87626098883966e-10, -9.54884821017932e-10, 0.400000000715017, -9.03440354098912e-10, 6.87176670690827e-10, -1.9265834182262e-11, 0.400000000090871, -1.37897100110271e-10, -9.477776697585e-10, -5.59971812584618e-10, 1.55201910054586e-10, 1.64697438702972e-11, -2.83787696225263e-10, 0.400000000081436, 0.400000000474617, 2.52710631097457e-10, 2.15265065855633e-11, 4.60006945801368e-10, 0.400000000350051, 0.400000000589324, -6.14290418047316e-10, 0.399999999873175, 3.55275616349519e-10, 9.1865874289896e-11, -9.42687221775074e-11, 0.399999999828229, -4.77461477022512e-10, 5.09646440219742e-10, -2.12358687827878e-10, 8.05569038043131e-11, 2.14046849893057e-10, 1.83282009289469e-10, -1.39569001259456e-11, 1.58453878542333e-10, 0.399999999992555 
## residual sum-of-squares: 6.73e-17
## reason terminated: Relative error between `par&#39; and the solution is at most `ptol&#39;.
</code></pre>

<pre><code class="r">signif(reshape.with.diag(solve.lev.marq$par, n_v), digits=4)
</code></pre>

<pre><code>##            [,1]       [,2]       [,3]       [,4]       [,5]       [,6]
## [1,]  0.000e+00  4.000e-01 -1.927e-11  1.647e-11  4.600e-10  9.187e-11
## [2,]  4.000e-01  0.000e+00  4.000e-01 -2.838e-10  4.000e-01 -9.427e-11
## [3,] -6.242e-12 -8.876e-10  0.000e+00  4.000e-01  4.000e-01  4.000e-01
## [4,] -3.317e-11 -9.549e-10 -1.379e-10  0.000e+00 -6.143e-10 -4.775e-10
## [5,] -7.531e-10  4.000e-01 -9.478e-10  4.000e-01  0.000e+00  5.096e-10
## [6,]  1.692e-10 -9.034e-10 -5.600e-10  2.527e-10  4.000e-01  0.000e+00
## [7,]  1.217e-10  6.872e-10  1.552e-10  2.153e-11  3.553e-10 -2.124e-10
##            [,7]
## [1,]  8.056e-11
## [2,]  2.140e-10
## [3,]  1.833e-10
## [4,] -1.396e-11
## [5,]  1.585e-10
## [6,]  4.000e-01
## [7,]  0.000e+00
</code></pre>

<pre><code>solve.nelder.mead &lt;- nelder.mead()
</code></pre>

<pre><code class="r">print(solve.nelder.mead)
</code></pre>

<pre><code>## $par
## [1]  9.982e-02  8.360e-05  4.001e-01 -6.436e-05 -3.736e-05  3.000e-01
## 
## $value
## [1] 6.142e-07
## 
## $counts
## function gradient 
##     1457       NA 
## 
## $convergence
## [1] 0
## 
## $message
## NULL
</code></pre>

<pre><code class="r">signif(reshape.with.diag(solve.nelder.mead$par, n_v), digits=4)
</code></pre>

<pre><code>## Warning: data length [13] is not a sub-multiple or multiple of the number
## of rows [7]
</code></pre>

<pre><code>##            [,1] [,2]       [,3]    [,4]       [,5]      [,6]       [,7]
## [1,]  0.000e+00    0  9.982e-02 0.00000  8.360e-05 0.0000000  4.001e-01
## [2,]  9.982e-02    0  8.360e-05 0.00000  4.001e-01 0.0000000 -6.436e-05
## [3,]  8.360e-05    0  4.001e-01 0.00000 -6.436e-05 0.0000000 -3.736e-05
## [4,]  4.001e-01    0 -6.436e-05 0.00000 -3.736e-05 0.0000000  3.000e-01
## [5,] -6.436e-05    0 -3.736e-05 0.00000  3.000e-01 0.0000000  0.000e+00
## [6,] -3.736e-05    0  3.000e-01 0.00000  0.000e+00 0.0998200  0.000e+00
## [7,]  3.000e-01    0  0.000e+00 0.09982  0.000e+00 0.0000836  0.000e+00
</code></pre>

<pre><code>solve.sim.anneal &lt;- sim.anneal()
</code></pre>

<pre><code class="r">print(solve.sim.anneal)
</code></pre>

<pre><code>## $par
## [1]  0.2908  0.1170  0.2208 -0.1242 -0.1406  0.4259
## 
## $value
## [1] 0.1337
## 
## $counts
## function gradient 
##    20000       NA 
## 
## $convergence
## [1] 0
## 
## $message
## NULL
</code></pre>

<pre><code class="r">signif(reshape.with.diag(solve.sim.anneal$par, n_v), digits=4)
</code></pre>

<pre><code>## Warning: data length [13] is not a sub-multiple or multiple of the number
## of rows [7]
</code></pre>

<pre><code>##         [,1] [,2]    [,3]   [,4]    [,5]   [,6]    [,7]
## [1,]  0.0000    0  0.2908 0.0000  0.1170 0.0000  0.2208
## [2,]  0.2908    0  0.1170 0.0000  0.2208 0.0000 -0.1242
## [3,]  0.1170    0  0.2208 0.0000 -0.1242 0.0000 -0.1406
## [4,]  0.2208    0 -0.1242 0.0000 -0.1406 0.0000  0.4259
## [5,] -0.1242    0 -0.1406 0.0000  0.4259 0.0000  0.0000
## [6,] -0.1406    0  0.4259 0.0000  0.0000 0.2908  0.0000
## [7,]  0.4259    0  0.0000 0.2908  0.0000 0.1170  0.0000
</code></pre>

<p>We see that the results in the solution vector (called <code>par</code>, for the parameter vector) is quite similar for BFGS and Nelder Mead. This is reassuring as BFGS is a gradient method (and its performance generally depends on the initial guess), whereas Nelder-Mead is a global search method whose ability to find a minimum is less dependent on the intialization point. Thus, our method can show us with some confidence where the global minimum is.</p>

<p>Furthermore, we see that our method has done well in finding the global minimum in this case, as the output matrices are very close to the original seeded interaction matrix.</p>

</body>

</html>
